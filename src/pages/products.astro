---
import Layout from '../layouts/Layout.astro';
import Navbar from '../components/Navbar.astro';
import Footer from '../components/Footer.astro';
import CategorySection from '../components/CategorySection.astro';

// Dummy data for demonstration
const dummyCategories = [
  {
    id: "cat1",
    name: "Surgical Instruments",
    description: "Professional surgical instruments for medical training and education. High-quality tools designed for hands-on learning experiences in surgical procedures and techniques.",
    image: "https://images.pexels.com/photos/4386467/pexels-photo-4386467.jpeg?auto=compress&cs=tinysrgb&w=800"
  },
  {
    id: "cat2",
    name: "Diagnostic Equipment",
    description: "Advanced diagnostic tools and equipment for comprehensive medical training. Essential instruments for learning patient assessment and diagnostic procedures.",
    image: "https://images.pexels.com/photos/4386467/pexels-photo-4386467.jpeg?auto=compress&cs=tinysrgb&w=800"
  },
  {
    id: "cat3",
    name: "Patient Care Supplies",
    description: "Complete range of patient care supplies and consumables for medical training environments. Quality products for hands-on healthcare education.",
    image: "https://images.pexels.com/photos/4386467/pexels-photo-4386467.jpeg?auto=compress&cs=tinysrgb&w=800"
  },
  {
    id: "cat4",
    name: "Laboratory Equipment",
    description: "State-of-the-art laboratory equipment for medical and scientific training. Professional-grade instruments for educational laboratory settings.",
    image: "https://images.pexels.com/photos/4386467/pexels-photo-4386467.jpeg?auto=compress&cs=tinysrgb&w=800"
  },
  {
    id: "cat5",
    name: "Emergency Medicine",
    description: "Critical emergency medicine equipment for training healthcare professionals. Essential tools for emergency response and trauma care education.",
    image: "https://images.pexels.com/photos/4386467/pexels-photo-4386467.jpeg?auto=compress&cs=tinysrgb&w=800"
  }
];

const dummyProducts = [
  // Surgical Instruments
  {
    id: "prod1",
    name: "Professional Surgical Scalpel Set",
    description: "High-precision surgical scalpel set with multiple blade sizes for comprehensive surgical training. Ergonomic design for optimal handling and control.",
    serialNumber: "SS-2024-001",
    categoryId: "cat1",
    image: "https://images.pexels.com/photos/4386467/pexels-photo-4386467.jpeg?auto=compress&cs=tinysrgb&w=800",
    variations: [
      {
        name: "Standard Set",
        attributes: [
          { title: "Blade Sizes", value: "10, 11, 15, 22" },
          { title: "Handle Material", value: "Stainless Steel" }
        ]
      },
      {
        name: "Extended Set",
        attributes: [
          { title: "Blade Sizes", value: "10, 11, 12, 15, 20, 22, 23" },
          { title: "Handle Material", value: "Titanium Alloy" }
        ]
      }
    ]
  },
  {
    id: "prod2",
    name: "Surgical Forceps Collection",
    description: "Complete collection of surgical forceps for various medical procedures. Precision-engineered instruments for professional medical training programs.",
    serialNumber: "SF-2024-002",
    categoryId: "cat1",
    image: "https://images.pexels.com/photos/4386467/pexels-photo-4386467.jpeg?auto=compress&cs=tinysrgb&w=800",
    variations: [
      {
        name: "Basic Collection",
        attributes: [
          { title: "Types", value: "Tissue, Hemostatic, Dressing" },
          { title: "Length", value: "12-16 cm" }
        ]
      }
    ]
  },
  {
    id: "prod3",
    name: "Surgical Scissors Set",
    description: "Professional-grade surgical scissors designed for precision cutting in medical training environments. Multiple types for different surgical applications.",
    serialNumber: "SC-2024-003",
    categoryId: "cat1",
    image: "https://images.pexels.com/photos/4386467/pexels-photo-4386467.jpeg?auto=compress&cs=tinysrgb&w=800",
    variations: [
      {
        name: "Standard Set",
        attributes: [
          { title: "Types", value: "Straight, Curved, Dissecting" },
          { title: "Material", value: "German Stainless Steel" }
        ]
      }
    ]
  },
  
  // Diagnostic Equipment
  {
    id: "prod4",
    name: "Digital Stethoscope Pro",
    description: "Advanced digital stethoscope with noise cancellation and recording capabilities. Perfect for medical training and patient assessment education.",
    serialNumber: "DS-2024-004",
    categoryId: "cat2",
    image: "https://images.pexels.com/photos/4386467/pexels-photo-4386467.jpeg?auto=compress&cs=tinysrgb&w=800",
    variations: [
      {
        name: "Standard Model",
        attributes: [
          { title: "Frequency Range", value: "20Hz - 20kHz" },
          { title: "Battery Life", value: "40 hours" }
        ]
      },
      {
        name: "Advanced Model",
        attributes: [
          { title: "Frequency Range", value: "5Hz - 25kHz" },
          { title: "Battery Life", value: "60 hours" },
          { title: "Features", value: "Bluetooth, Recording" }
        ]
      }
    ]
  },
  {
    id: "prod5",
    name: "Blood Pressure Monitor Set",
    description: "Professional blood pressure monitoring system for medical training. Accurate measurements with digital display and multiple cuff sizes.",
    serialNumber: "BP-2024-005",
    categoryId: "cat2",
    image: "https://images.pexels.com/photos/4386467/pexels-photo-4386467.jpeg?auto=compress&cs=tinysrgb&w=800",
    variations: [
      {
        name: "Manual Set",
        attributes: [
          { title: "Cuff Sizes", value: "Adult, Large Adult" },
          { title: "Gauge Type", value: "Aneroid" }
        ]
      },
      {
        name: "Digital Set",
        attributes: [
          { title: "Cuff Sizes", value: "Pediatric, Adult, Large Adult" },
          { title: "Display", value: "LCD Digital" }
        ]
      }
    ]
  },
  
  // Patient Care Supplies
  {
    id: "prod6",
    name: "Medical Examination Gloves",
    description: "High-quality disposable examination gloves for medical training and patient care. Latex-free options available for sensitive users.",
    serialNumber: "EG-2024-006",
    categoryId: "cat3",
    image: "https://images.pexels.com/photos/4386467/pexels-photo-4386467.jpeg?auto=compress&cs=tinysrgb&w=800",
    variations: [
      {
        name: "Nitrile Gloves",
        attributes: [
          { title: "Material", value: "Nitrile" },
          { title: "Sizes", value: "S, M, L, XL" },
          { title: "Quantity", value: "100 per box" }
        ]
      },
      {
        name: "Vinyl Gloves",
        attributes: [
          { title: "Material", value: "Vinyl" },
          { title: "Sizes", value: "S, M, L, XL" },
          { title: "Quantity", value: "100 per box" }
        ]
      }
    ]
  },
  {
    id: "prod7",
    name: "Sterile Gauze Pads",
    description: "Premium sterile gauze pads for wound care training and medical procedures. Various sizes available for different applications.",
    serialNumber: "GP-2024-007",
    categoryId: "cat3",
    image: "https://images.pexels.com/photos/4386467/pexels-photo-4386467.jpeg?auto=compress&cs=tinysrgb&w=800",
    variations: [
      {
        name: "Standard Pack",
        attributes: [
          { title: "Sizes", value: "2x2, 4x4 inches" },
          { title: "Quantity", value: "25 per pack" }
        ]
      }
    ]
  },
  
  // Laboratory Equipment
  {
    id: "prod8",
    name: "Digital Microscope System",
    description: "High-resolution digital microscope for laboratory training and research. Advanced imaging capabilities with computer connectivity.",
    serialNumber: "DM-2024-008",
    categoryId: "cat4",
    image: "https://images.pexels.com/photos/4386467/pexels-photo-4386467.jpeg?auto=compress&cs=tinysrgb&w=800",
    variations: [
      {
        name: "Standard Model",
        attributes: [
          { title: "Magnification", value: "40x - 1000x" },
          { title: "Camera", value: "5MP Digital" }
        ]
      },
      {
        name: "Professional Model",
        attributes: [
          { title: "Magnification", value: "40x - 2000x" },
          { title: "Camera", value: "12MP Digital" },
          { title: "Features", value: "WiFi, Touch Screen" }
        ]
      }
    ]
  },
  
  // Emergency Medicine
  {
    id: "prod9",
    name: "Emergency Response Kit",
    description: "Comprehensive emergency response kit for training healthcare professionals in critical care situations. Contains essential emergency medical supplies.",
    serialNumber: "ER-2024-009",
    categoryId: "cat5",
    image: "https://images.pexels.com/photos/4386467/pexels-photo-4386467.jpeg?auto=compress&cs=tinysrgb&w=800",
    variations: [
      {
        name: "Basic Kit",
        attributes: [
          { title: "Components", value: "20 Essential Items" },
          { title: "Case", value: "Portable Hard Case" }
        ]
      },
      {
        name: "Advanced Kit",
        attributes: [
          { title: "Components", value: "35 Essential Items" },
          { title: "Case", value: "Rolling Hard Case" },
          { title: "Features", value: "LED Light, Power Bank" }
        ]
      }
    ]
  }
];

// Group products by category
const categorizedProducts = {};
dummyCategories.forEach(category => {
  categorizedProducts[category.id] = {
    category: category,
    products: dummyProducts.filter(product => product.categoryId === category.id)
  };
});

// Generate category anchors for navigation
const categoryAnchors = dummyCategories.map(cat => ({
  id: cat.id,
  name: cat.name,
  anchor: cat.name.toLowerCase().replace(/[^a-z0-9]+/g, '-').replace(/(^-|-$)/g, ''),
  productCount: categorizedProducts[cat.id]?.products?.length || 0
}));

// Calculate total products
const totalProducts = dummyProducts.length;
---

<Layout 
  title="Medical Equipment Products - Swiss Trade Ventures" 
  description="Explore our comprehensive range of premium medical equipment and training products. Professional healthcare solutions for medical training institutions worldwide."
>
  <Navbar />
  
  <!-- Main Products Layout -->
  <div class="min-h-screen bg-white">
    <div class="flex">
      
      <!-- Left Sidebar - Fixed Categories Index (25% width) -->
      <aside class="fixed left-0 top-32 w-1/4 z-30 p-6">
        <div class="bg-white/95 backdrop-blur-md rounded-3xl border border-blue-500 p-6 shadow-sm">
          <!-- Sidebar Header -->
          <div class="mb-8">
            <h2 class="text-xl font-bold text-gray-900 mb-2" style="font-family: 'Space Grotesk', sans-serif;">
              Product Categories
            </h2>
            <p class="text-sm text-gray-600">
              {dummyCategories.length} categories â€¢ {totalProducts} products
            </p>
          </div>

          <!-- Categories Navigation -->
          <nav class="space-y-2" aria-label="Product categories">
            {categoryAnchors.map((category) => (
              <a 
                href={`#${category.anchor}`}
                class="category-nav-item group flex items-center justify-between p-3 rounded-xl text-gray-700 hover:text-blue-600 hover:bg-blue-50 transition-all duration-200 border border-transparent hover:border-blue-200"
                data-category={category.anchor}
              >
                <span class="text-sm font-medium truncate pr-2">{category.name}</span>
                <span class="flex-shrink-0 inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-600 group-hover:bg-blue-100 group-hover:text-blue-700 transition-colors duration-200">
                  {category.productCount}
                </span>
              </a>
            ))}
          </nav>

          <!-- Total Products Summary -->
          <div class="mt-8 pt-6 border-t border-gray-200">
            <div class="text-center">
              <div class="text-2xl font-bold text-blue-600" style="font-family: 'Space Grotesk', sans-serif;">
                {totalProducts}
              </div>
              <div class="text-sm text-gray-600">Total Products</div>
            </div>
          </div>
        </div>
      </aside>

      <!-- Right Content Area (75% width) -->
      <main class="ml-1/4 w-3/4 min-h-screen">
        <div class="pl-20 pr-8 py-8 pt-40">
          
          <!-- Page Header -->
          <div class="mb-20">
            <h1 class="text-4xl font-bold text-gray-900 mb-6" style="font-family: 'Space Grotesk', sans-serif;">
              Medical Equipment Products
            </h1>
            <p class="text-lg text-gray-600 max-w-3xl leading-relaxed">
              Discover our comprehensive range of premium medical equipment designed for professional healthcare training and education. Each product meets international quality standards and comes with detailed specifications for optimal learning experiences.
            </p>
          </div>

          <!-- Category Sections -->
          {Object.entries(categorizedProducts).map(([categoryId, categoryData]) => (
            <CategorySection 
              category={categoryData.category} 
              products={categoryData.products} 
            />
          ))}
        </div>
      </main>
    </div>
  </div>

  <Footer />
</Layout>

<!-- Enhanced JavaScript for Premium Interactions -->
<script>
document.addEventListener('DOMContentLoaded', function() {
  // Smooth scrolling for category navigation
  const categoryNavItems = document.querySelectorAll('.category-nav-item');
  const categorySection = document.querySelectorAll('.category-section');
  
  // Category navigation with active state
  categoryNavItems.forEach(item => {
    item.addEventListener('click', function(e) {
      e.preventDefault();
      const targetId = this.getAttribute('href').substring(1);
      const targetSection = document.getElementById(targetId);
      
      if (targetSection) {
        // Update active state
        categoryNavItems.forEach(nav => nav.classList.remove('active'));
        this.classList.add('active');
        
        // Smooth scroll to section
        targetSection.scrollIntoView({
          behavior: 'smooth',
          block: 'start'
        });
        
        // Update URL without triggering scroll
        history.pushState(null, null, `#${targetId}`);
      }
    });
  });

  // Intersection Observer for active category highlighting
  const observerOptions = {
    root: null,
    rootMargin: '-20% 0px -70% 0px',
    threshold: 0
  };

  const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        const categoryId = entry.target.getAttribute('data-category');
        
        // Update active navigation item
        categoryNavItems.forEach(nav => {
          nav.classList.remove('active');
          if (nav.getAttribute('data-category') === categoryId) {
            nav.classList.add('active');
          }
        });
      }
    });
  }, observerOptions);

  // Observe all category sections
  categorySection.forEach(section => {
    observer.observe(section);
  });

  // Horizontal scroll functionality for products
  const scrollButtons = document.querySelectorAll('.scroll-btn');
  
  scrollButtons.forEach(button => {
    button.addEventListener('click', function() {
      const targetId = this.getAttribute('data-target');
      const container = document.getElementById(targetId);
      const scrollAmount = 320; // Width of one product card + gap
      
      if (this.classList.contains('scroll-left')) {
        container.scrollBy({ left: -scrollAmount, behavior: 'smooth' });
      } else {
        container.scrollBy({ left: scrollAmount, behavior: 'smooth' });
      }
    });
  });

  // Show/hide scroll buttons based on scroll position
  const productsContainers = document.querySelectorAll('.products-scroll');
  
  productsContainers.forEach(container => {
    const categoryId = container.id.replace('products-', '');
    const leftBtn = document.querySelector(`.scroll-left[data-target="products-${categoryId}"]`);
    const rightBtn = document.querySelector(`.scroll-right[data-target="products-${categoryId}"]`);
    
    function updateScrollButtons() {
      const { scrollLeft, scrollWidth, clientWidth } = container;
      
      // Show/hide left button
      if (scrollLeft > 0) {
        leftBtn.style.opacity = '1';
      } else {
        leftBtn.style.opacity = '0';
      }
      
      // Show/hide right button
      if (scrollLeft + clientWidth < scrollWidth - 10) {
        rightBtn.style.opacity = '1';
      } else {
        rightBtn.style.opacity = '0';
      }
    }
    
    container.addEventListener('scroll', updateScrollButtons);
    updateScrollButtons(); // Initial check
  });

  // Handle initial hash in URL
  if (window.location.hash) {
    const targetId = window.location.hash.substring(1);
    const targetSection = document.getElementById(targetId);
    if (targetSection) {
      setTimeout(() => {
        targetSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
      }, 100);
    }
  }

  // Image lazy loading optimization
  const images = document.querySelectorAll('img[loading="lazy"]');
  
  if ('IntersectionObserver' in window) {
    const imageObserver = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          const img = entry.target;
          img.classList.add('fade-in');
          imageObserver.unobserve(img);
        }
      });
    });
    
    images.forEach(img => imageObserver.observe(img));
  }
});
</script>

<!-- Enhanced Styles for Premium Design -->
<style>
/* Hide scrollbars for horizontal scroll */
.products-scroll::-webkit-scrollbar {
  display: none;
}

/* Active category navigation state */
.category-nav-item.active {
  background-color: #dbeafe;
  border-color: #3b82f6;
  color: #1d4ed8;
}

.category-nav-item.active span:last-child {
  background-color: #3b82f6;
  color: white;
}

/* Smooth scroll behavior */
html {
  scroll-behavior: smooth;
}

/* Image fade-in animation */
.fade-in {
  animation: fadeIn 0.5s ease-in-out;
}

@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

/* Responsive design */
@media (max-width: 1024px) {
  aside {
    display: none;
  }
  
  main {
    margin-left: 0;
    width: 100%;
  }
  
  main > div {
    padding-left: 2rem !important;
  }
}

/* Performance optimizations */
.product-card {
  contain: layout style paint;
}

.products-scroll {
  contain: layout style;
}

/* Accessibility improvements */
@media (prefers-reduced-motion: reduce) {
  html {
    scroll-behavior: auto;
  }
  
  .product-card {
    transition: none;
  }
  
  .scroll-btn {
    transition: none;
  }
}

/* High contrast mode support */
@media (prefers-contrast: high) {
  .category-nav-item {
    border: 2px solid;
  }
  
  .product-card {
    border: 2px solid;
  }
}
</style>